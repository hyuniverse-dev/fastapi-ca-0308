<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>비밀번호 찾기 | 서비스명</title>
  <style>
    /* 기본 스타일 초기화 */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
    }

    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #333;
    }

    .container {
      width: 100%;
      max-width: 400px;
      padding: 40px 20px;
    }

    .forgot-password-box {
      background-color: white;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      padding: 40px;
      text-align: center;
      transition: transform 0.3s ease;
    }

    .forgot-password-box:hover {
      transform: translateY(-5px);
    }

    .logo {
      margin-bottom: 30px;
    }

    .logo svg {
      width: 80px;
      height: 80px;
    }

    h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #333;
    }

    .subtitle {
      font-size: 14px;
      color: #666;
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
      text-align: left;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 500;
      color: #555;
    }

    .form-control {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 15px;
      transition: all 0.3s ease;
    }

    .form-control:focus {
      border-color: #4A6CF7;
      box-shadow: 0 0 0 3px rgba(74, 108, 247, 0.2);
      outline: none;
    }

    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 14px 20px;
      border-radius: 10px;
      border: none;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      position: relative;
      overflow: hidden;
      width: 100%;
    }

    .btn:active {
      transform: scale(0.98);
    }

    .btn-primary {
      background-color: #4A6CF7;
      color: white;
      margin-bottom: 15px;
    }

    .btn-primary:hover {
      background-color: #3a5bd9;
      box-shadow: 0 5px 15px rgba(74, 108, 247, 0.3);
    }

    .btn-back {
      background-color: transparent;
      color: #555;
      border: 1px solid #ddd;
    }

    .btn-back:hover {
      background-color: #f5f5f5;
    }

    .btn-icon {
      width: 20px;
      height: 20px;
      margin-right: 10px;
    }

    .footer {
      margin-top: 30px;
      font-size: 13px;
      color: #888;
    }

    .footer a {
      color: #4A6CF7;
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    .alert {
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      display: none;
    }

    .alert-success {
      background-color: rgba(72, 187, 120, 0.1);
      color: #2f855a;
      border: 1px solid rgba(72, 187, 120, 0.2);
    }

    .alert-danger {
      background-color: rgba(245, 101, 101, 0.1);
      color: #e53e3e;
      border: 1px solid rgba(245, 101, 101, 0.2);
    }

    .error-message {
      color: #e74c3c;
      font-size: 13px;
      margin-top: 5px;
      display: none;
      text-align: left;
    }

    /* 로딩 스피너 */
    .loading {
      display: none;
      position: relative;
      width: 40px;
      height: 40px;
      margin: 20px auto;
    }

    .loading div {
      box-sizing: border-box;
      display: block;
      position: absolute;
      width: 32px;
      height: 32px;
      margin: 4px;
      border: 4px solid #4A6CF7;
      border-radius: 50%;
      animation: loading 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
      border-color: #4A6CF7 transparent transparent transparent;
    }

    .loading div:nth-child(1) {
      animation-delay: -0.45s;
    }

    .loading div:nth-child(2) {
      animation-delay: -0.3s;
    }

    .loading div:nth-child(3) {
      animation-delay: -0.15s;
    }

    @keyframes loading {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    /* 물결 효과 */
    .ripple {
      position: absolute;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      transform: scale(0);
      animation: ripple 0.6s linear;
      pointer-events: none;
    }

    @keyframes ripple {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }

    /* 반응형 디자인 */
    @media (max-width: 480px) {
      .container {
        padding: 20px;
      }

      .forgot-password-box {
        padding: 30px 20px;
      }

      h1 {
        font-size: 22px;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <div class="forgot-password-box">
    <div class="logo">
      <!-- 로고 (SVG 사용) -->
      <svg width="80" height="80" viewBox="0 0 80 80" fill="none"
           xmlns="http://www.w3.org/2000/svg">
        <circle cx="40" cy="40" r="40" fill="#4A6CF7" fill-opacity="0.1"/>
        <path d="M52 28H28V52H52V28Z" stroke="#4A6CF7" stroke-width="4" stroke-linecap="round"
              stroke-linejoin="round"/>
        <path d="M28 40H52" stroke="#4A6CF7" stroke-width="4" stroke-linecap="round"
              stroke-linejoin="round"/>
        <path d="M40 28V52" stroke="#4A6CF7" stroke-width="4" stroke-linecap="round"
              stroke-linejoin="round"/>
      </svg>
    </div>

    <h1>비밀번호 찾기</h1>
    <p class="subtitle">가입한 이메일 주소를 입력하시면 임시 비밀번호를 보내드립니다</p>

    <div id="alertSuccess" class="alert alert-success">
      임시 비밀번호가 이메일로 발송되었습니다. 메일함을 확인해주세요.
    </div>

    <div id="alertError" class="alert alert-danger">
      이메일 주소를 찾을 수 없습니다. 가입 시 사용한 이메일을 확인해주세요.
    </div>

    <form id="forgotPasswordForm">
      <div class="form-group">
        <label for="email" class="form-label">이메일</label>
        <input type="email" id="email" name="email" class="form-control"
               placeholder="example@email.com" required>
        <div id="emailError" class="error-message">유효한 이메일 주소를 입력해주세요.</div>
      </div>

      <div class="loading" id="loadingSpinner">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>

      <button type="submit" id="submitBtn" class="btn btn-primary">임시 비밀번호 발급</button>

      <a href="/view/users/login" class="btn btn-back">
        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round"/>
          <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round"/>
        </svg>
        로그인 페이지로 돌아가기
      </a>
    </form>

    <div class="footer">
      <p>계정이 없으신가요? <a href="/view/users/signup">회원가입</a></p>
    </div>
  </div>
</div>

<script>
  // 폼 제출 처리
  const forgotPasswordForm = document.getElementById('forgotPasswordForm');
  const emailInput = document.getElementById('email');
  const emailError = document.getElementById('emailError');
  const alertSuccess = document.getElementById('alertSuccess');
  const alertError = document.getElementById('alertError');
  const loadingSpinner = document.getElementById('loadingSpinner');
  const submitBtn = document.getElementById('submitBtn');

  forgotPasswordForm.addEventListener('submit', async function (e) {
    e.preventDefault();

    // 이메일 유효성 검사
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailPattern.test(emailInput.value)) {
      emailError.style.display = 'block';
      return;
    } else {
      emailError.style.display = 'none';
    }

    // 알림 메시지 초기화
    alertSuccess.style.display = 'none';
    alertError.style.display = 'none';

    // 로딩 스피너 표시
    loadingSpinner.style.display = 'block';
    submitBtn.disabled = true;

    try {
      // API 호출
      // const formData = new FormData(emailInput);
      // const data = Object.fromEntries(formData.entries());

      const response = await fetch('/api/users/forgot-password', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({"email": emailInput.value})
      });

      // 로딩 스피너 숨김
      loadingSpinner.style.display = 'none';
      submitBtn.disabled = false;
      console.log(response);
      console.log(response.statusText);
      if (response.ok) {
        // 성공 알림 표시
        alertSuccess.style.display = 'block';
        // 폼 초기화
        forgotPasswordForm.reset();
      } else {
        // 응답 데이터 가져오기
        const data = await response.json();
        // 오류 알림 표시
        alertError.textContent = data.detail || '이메일 주소를 찾을 수 없습니다. 가입 시 사용한 이메일을 확인해주세요.';
        alertError.style.display = 'block';
      }
    } catch (error) {
      // 로딩 스피너 숨김
      loadingSpinner.style.display = 'none';
      submitBtn.disabled = false;

      // 오류 알림 표시
      alertError.textContent = '서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.';
      alertError.style.display = 'block';
      console.error('Error:', error);
    }
  });

  // 버튼 물결 효과
  document.querySelectorAll('.btn').forEach(button => {
    button.addEventListener('click', function (e) {
      // 버튼이 비활성화되어 있으면 효과 적용 안함
      if (this.disabled) {
        return;
      }

      // 현재 버튼 내에서의 클릭 위치 계산
      const x = e.clientX - e.target.getBoundingClientRect().left;
      const y = e.clientY - e.target.getBoundingClientRect().top;

      // 물결 효과 요소 생성
      const ripple = document.createElement('span');
      ripple.classList.add('ripple');
      ripple.style.left = `${x}px`;
      ripple.style.top = `${y}px`;

      // 버튼에 물결 효과 요소 추가
      this.appendChild(ripple);

      // 애니메이션 완료 후 요소 제거
      setTimeout(() => {
        ripple.remove();
      }, 600);
    });
  });

  // 페이지 로드 애니메이션
  document.addEventListener('DOMContentLoaded', function () {
    const forgotPasswordBox = document.querySelector('.forgot-password-box');
    forgotPasswordBox.style.opacity = '0';
    forgotPasswordBox.style.transform = 'translateY(20px)';

    setTimeout(() => {
      forgotPasswordBox.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
      forgotPasswordBox.style.opacity = '1';
      forgotPasswordBox.style.transform = 'translateY(0)';
    }, 100);
  });
</script>
</body>
</html>
